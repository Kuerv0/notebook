--------------------------------------------------------------------------------
Primera clase
--------------------------------------------------------------------------------
Mon Feb  5 12:07:27 2024

SIA

3 parciales 20%

Tareas 20% 

Final práctico 20%

* 10% Curso autoestudio.

NetAcad

Examen cap 20%

Tareas 30%

Final teórico 20%

Final práctico 30%

CCNA

- Switching
- Wireless
- Routing

#do [comando] -> En cualquier modo para ejecuar comando.

Los mensajes que aparecen se conocen como logs. Lo ideal es ponerle un salto de
linea.

configure terminal
line con 0
loggin synchronous 

show cdp -> Cisco Discovery Protocol
show cdp neighbor -> Para ver los vecinos
show cdp neighbor detail -> Para ver los detalles de los vecinos.

--------------------------------------------------------------------------------
Segunda clase
--------------------------------------------------------------------------------
Tue Feb  6 11:56:17 2024
Hoy quiero retomar algunos conceptos de redes 1 porque lo vamos a necesitar para
el jueves. El concepto que quiero que revisemos es qué es un dominio de colisión
y qué es un dominio de broadcast. No es una métrica, pero le da una pista del
diseño de la red. 

Colisión: Es cuando dos señales se superponen.

Una colisión es una situación que no deseamos en las redes. Si hay muchas
colisiones alguien hizo algo mal. No es una métrica, pero es una pista de si la
red está bien o mal diseñada. Si de un Access Point se pegan muchos usuarios lo
que va a pasar es que la red se pone muy lenta, no hay colisiones porque las
redes wireless evitan las colisiones, sin embargo, la red se va a saturar. Esto
también sucede con las redes móviles en lugares donde hay muchas personas.

Las colisiones se presentan cuando no hay segmentación de capa 2 para arriba, si
solo hay equipos de capa 1, las colisiones se van a sentir en todos los equipos
y por ende todos los equipos pararían. Señal jam es la que avisa que hay
colisión en los equipos. Cuando hay muchas colisiones se siente lenta la red,
ahora que lo estamos buscando es que si ocurre una colisión, solo se vea
afectado en una parte de la red.

Dominio de colisión es el conjunto de dispositivos afectados en una colisión,
los equipos de capa 2 para arriba.

En la vida real los computadores ya tienen servicios capa 2. 

Los hubs son un replicador de señales y poco más.

Los dominios de colisión se definen por cada puerto del switch.

Una red preferiblemente tendrá pequeños, pero muchos dominios de colisión.

El switch tiene buffers, esto ayuda a las colisiones. Pero, un switch puede
tener colisiones si trabaja en half-duplex.

Los dominions de broadcast también nos dan una idea de qué tan buena es la
topología. 

El hub es un loro, todo lo que llega lo replica por todos los puertos excepto
por el que llegó la información. Esto es un problema de seguridad, los switches,
en cambio, tienen tablas MAC que dan más idea de dónde sacar el paquete.  

Cuando el mensaje es un broadcast, el switch se comporta similar a un hub,
enviando la información por todos los puertos. 

Los routers construyen pequeños dominions de broadcast.
Los switches construyen pequeños dominions de colisión. Los routers también.

La MAC de router se puede consultar con show int [interface]

#show mac address-table
#clear mac address-table | #clear mac address-table *

el cdp se envía cada 60 segundos.

Cuando un switch pregunta por una MAC que no conoce, NO ES UN BROADCAST, es un
flood. *

Hay un comando para agregar entradas a la tabla MAC, con unas tácticas de
ciberseguridad podemos agregar MACs manual y engañar al switch para que no
aprenda MACs desde paquetes para que nunca vaya a cambiar la MAC de un servidor,
por ejemplo.

Hay momentos en los que hay más entradas en la tabla MAC y esto puede sugerir un
comportamiento malicioso.

--------------------------------------------------------------------------------
Tercera clase
--------------------------------------------------------------------------------
Thu Feb  8 12:08:40 2024

Mientras uses switches, aunque uses redes diferentes, habrá solo un dominio de
broadcast.

Si hay n redes, debe haber n dominios de broadcast.

Las VLAN las manejan los switches. Son una forma de aislar grupos por
software. Cada VLAN es un dominio de broadcast separado.

#show vlan -> mostrar vlans.

(config)# vlan 10
  name [nombre]
#vlan 20
  name [nombre]

La regla inicial era que el router separaba los domiinos de broadcast, a esta
regla vamos a agregar una excepción, de modo que para n vlans, tenemos n
dominios de broadcast.

(config)#int range fa0/1 - 10 
  switchport access vlan 10

Los puertos mixtos los vamos a llamar trunk, estos puertos pueden llevar
información de varias VLAN, los que son exclusivos de una VLAN, se conocen como
ACCESS.

El tag se pone en los enlaces trunk.

(config)# int range g0/1 - 2

  switchport mode trunk

Sin tag el estándar es 802.3 y con tag es 802.1q

Todos los puertos inician como access. El trunk es útil cuando tienes 2 o más
VLANs. Para los PCs se puede tener puertos trunk para máquinas virtuales.

802.1q -> Admite tráfico taggeado.

Un router se encarga de conectar VLANs, bueno, porque es lo mismo que una LAN en
teoría.

(config)# int g0/0.10
(config-if) encapsulation dot1Q [vlan number]
(config-if) ip address ...

--------------------------------------------------------------------------------
Cuarta clase
--------------------------------------------------------------------------------
Mon Feb 12 12:28:40 2024

Dirección APIPA: 169.254...
Esta dirección solo sirve para conectividad local, ipv6 se inspiró en esto para
hacer la Link Local, la iniciativa de esta dirección fue de Microsoft y luego
los otros Sistemas Operativos lo adaptaron, esta dirección aparece cuando no
encuentra servidor DHCP.

Cuando solo hay una vlan, usamos puentes de acceso.

LAN - Ethernet - enet
      FDDI 
      TokenRing

FDDI - protocolo en desuso de fibra para LAN.

show interface trunk -> Mostrar enlaces trunk.

show interface [] [] switchport

--------------------------------------------------------------------------------
Quinta clase
--------------------------------------------------------------------------------
Thu Feb 15 12:05:47 2024

VLAN ID - registro de 12 bits, 0 - 4095, pero no se incluyen los extremos.

En las VLANS existe un rango básico y un rango extendido.

Básico [1 - 1001]: Todos los protocolos soportan este rango. En una empresa
usted nunca va a necesitar más de 1000 VLANs.

Extendido [1006 - 4094]: No todos los equipos y no todos los protocolos soportan
el rango extendido.

Con el básico vamos derecho, con el extendido hay que revisar muy bien.

En la mitad entre básico y extendido están las VLANs especiales.

La cantidad de VLANs efectivas dependen de la RAM del switch, los 2960 permiten
255, los capa 3 soportan más.

El nombre de las VLANs no importa, pero el ID importa.

Es importante crear VLANs en todos los switches, si hay un trunk, pero un switch
envía información de una VLAN que el otro switch no tiene, descarta los
paquetes.

Puerto de Acceso: 1 VLAN. Estándar 802.3.
Puerto Troncales: Todas las VLANs. Estándar 802.1q. 

En los equipos finales, en general se usan puertos de acceso, pero hay
excepciones, como los servidores u ordenadores con máquinas virtuales en los que
es necesario diferente tráfico.

VLAN 1 - Por defecto - Default. Están todos los puertos inicialmente, no se
puede eliminar, no se puede cambiar el nombre, siempre será default. Lo único
que hacemos de la VLAN es tomar los puertos, se acostumbra no usarla. La VLAN
1 es un problema de seguridad porque un atacante tendría acceso a todos los
puertos con acceder a esta VLAN.

#show interface trunk -> self explanatory

El TCI es el tag y está en hex.

La VLAN nativa es la única VLAN que no tiene tag, por defecto es la VLAN 1, lo
mejor es crear una VLAN nativa para desechar los flujos que se dañan.

Solo puede haber una VLAN nativa por troncal porque se mezclan los flujos y no
se podría diferenciar.

(config)# interface []
(config-if)# switchport trunk native vlan [number]
#show interface trunk para validar si cambia la vlan a nativa.

Todo lo que llegue al switch sin etiqueta la manda por la vlan nativa, porque
es la única vlan que no se etiqueta en un troncal.

En el router tenemos que hacer un cambio, el router cree que todo llega con
etiqueta a menos que...

(config-subif)encapsulation dot1Q [number] native -> Hacer saber al router cuál
tráfico no tiene etiqueta. 

La VLAN administrativa, muchachos, sirve para gestionar o administrar el
switch. Es para poner la ip del switch.

#(configure)int vlan [vlan number]
()ip add [address] [mask]
#()no shutdown

--------------------------------------------------------------------------------
Sexta clase
--------------------------------------------------------------------------------
Mon Feb 19 12:07:09 2024

Podemos quitar VLANs del troncal cuando no queremos que se comunique con los
demás, por ejemplo, un ataque o pruebas que pueden inerferir con otros
equipos.

S(config)# interface [interface id]
S(config-if)# switchport trunk allowed vlan remove [id]

Se puede repartir el tráfico entre dos enlaces trunk.

El switch de capa 2, entiende los conceptos de capa 2, tiene puertos de acceso y
trunk, el router no tiene ninguno de los dos, el router tiene puertos de capa 3,
puertos enrutados. El switch no puede tener ip en ningún puerto, excepto con el
artificio interfaz vlan.

Un equipo capa 2, puede enviar tráfico entre la misma vlan, el equipo capa 3
comunica entre vlans.

El switch de capa 3 es lo mejor de ambos mundos.

Un switch de capa 3 es indistinguible de un switch capa 2.

Dynamic Trunking Protocol (DTP) -> Protocolo que comparte información cada 60
segundos entre switches y busca negociar el modo. O el puerto funciona en access
o el puerto funciona trunk. Los dos hacen la negociación, es posible negociar el
enlace... vamos a tener dos modos manuales o estaticos. Los cuales son accesso y
trunk (switchport access, switchport trunk).

Hay dos modos dinámicos en los equipos: Desirable, Auto.

Access nunca baila.
Trunk baila de todo.

Auto espera que lo saquen a bailar.
Desirable saca a bailar.

Bailar se refiere a trunk.

Modo operacional es como resulta de la negociación. 
show interface [interface] switchport.

Si un puerto de acceso se conecta a un trunk, solo funcionará bien con la vlan
nativa.

S(config-if)# switchport nonegotitate -> Deshabilitar negociación.

DTP también hace la negociación del encapsulamiento, Cisco tenía un
encapsulamiento propio: Cisco ISL, IEE 802.1q

S(config-if)switchport trunk encapsulation dot1q -> Para la negociación auto y
errores.

3 [SVI: int vlan 99] => Solo se crea para la vlan administrativa y es solo
una.
2 [vlan 99]
1 [Acceso o Trunk]

La ip solo se le da a la vlan administrativa.

La SVI se guarda en la RAM, pero también lo podemos guardar en la startup
config, en la  NVRAM, las vlan se guardan en un archivo en la Flash, en
vlan.dat.

Running, RAM: SVI 99
NVRAM

#delete vlan.dat -> eliminar vlans.

En un switch capa 3, por cada vlan, hay SVI.

Los multicapa traen el enrutamiento apagado.

S3(config)# ip routing
S(config)# ipv6 unicast routing

S(config-if)# no switchport -> Renunciar a capa 2 y tener capa 3 solamente.

Es preferible usar un Switch capa 3 a los routers en ciertos escenarios en los
que requieren mucha velocidad.

No usar multicapa cuando se usa WAN, DSL, etc.

--------------------------------------------------------------------------------
Séptima clase
--------------------------------------------------------------------------------
Tue Feb 20 11:47:58 2024

Redundancia

Siempre hay una necesidad que suplir, el primer problema es si yo le dejo solo
un enlace entre switches y ese enlace se cae, la conectividad se pierde, por lo
que queremos tener varios caminos para que los enlaces sean redunantes.

Tenemos múltiples caminos para llegar a otro lugar. Puede haber redundancia de
capa 2 y varios caminos capa 3.

El protocolo que nos ayuda a elegir un camino es spanning tree.

S(config)# no spanning-tree vlan [vlan-id] -> Desactivar spanning tree

FastEthernet costo 19

Giga costo 4


--------------------------------------------------------------------------------
Octava clase
--------------------------------------------------------------------------------
Thu Feb 22 12:15:46 2024

1. Elegir un un switch raíz por cada dominio de broadcast

Breach ID -> BID, ya no hay breach, todo el mundo le tira a los switches.
Cuando digamos breach pensemos en switches, es un identificador que tiene dos
valores. [prioridad 16 bits 0 - 65535 (32768)][MAC base 48 bits]

Menor BID es la root.

# show spanning-tree -> Mostrar info sobre el spanning tree.

Cuando el raíz está mal ubicado, hay rutas subóptimas. 

Criterios: El raíz debería ser el equipo de mejores especificaciones, los
equipos con mejor ubicación. [Acceso, distribución, core], ubicar el raíz lo más
cercano al recurso compartido (router, impresoras, servidor)

- Mejores especificaciones.
- Mejor ubicación (Nivel superior).
- Cercano al recurso compartido.

Hay dos formas de cambiar prioridad. 

- Bajar la prioridad manualmente.
#(config) spanning-tree vlan 1 priority 16384

- Bajar la prioridad de manera automática.
#(config)spanning-tree vlan1 root [primary, secondary]
De esta manera, baja escalones de 4096.

2. Elegir un puero ŕaíz por cada switch no raíz. 

Los switches que pierden, deben escoger un puerto para que sea el switch raíz.
El puerto raíz es el que nos lleva más rápido a raíz.

¿Cuál nos lleva más rápido al switch root?
[SENDER]

- Menor costo 10M -> 100, 100M -> 19, 1G -> 4, 10G -> 2.

Para puertos raíz.

- Menor BID Sender/vecino 

- Menor Port ID sender/vecino, escoge el menor puerto del vecino y ese es el
  raíz.

- Menor Port ID local.

Los costos son por dominio de colisión.

3. Elegir un puerto designado por cada dominio de colisión.

[RECIBIR]

Por cada dominio de colisión, hay un puerto designado, todos los puertos del
raíz son designados.

4. Bloquear los puertos que no son designados.

--------------------------------------------------------------------------------
Novena clase
--------------------------------------------------------------------------------
Mon Feb 26 11:53:32 2024

Es momento de saber cómo se logra esto en 30 segundos.

El primer elemento que quiero contarles es que spanning tree tiene unos
menssajes llamados los hellos, realmente llamados:

- BPDU Hello -> Cada 2 segundos se manda un hello por todos los puertos que
  están conectados. 

MAC origen en paquetes STP, MAC destino 0180.c200.0000

Forward Delay se refiere al tiempo que la información tarda en propagarse y sea
homogenea.

Estados STP

1. Down.
2. Listening (15 segundos).
3. Learning (15 segundos).
4. Forwarding or blocking.

Hay variantes de spanning tree para que no tome tanto tiempo. 30 segundos en la
actualidad es mucho tiempo.

STPF fue estarndarizado en IEE 802.1d, pero cisco empezó a hacer modificaciones
y hay que ser juicioso para revisar si son compatibles.

Árbol común es de la IEE802.1D, donde STP hay un raíz para todas las VLANs, pero
Cisco tiene PVSPT 

Dibujando STP

Los enlaces troncales se dibujan en todas las vlans
En los de acceso, metemos solo los que pertenecen a la vlan n

Si hay troncales, el puerto solo se pondrá naranja cuando todas las vlan están
bloqueadas.

STP y PVSTP no pueden comunicarse entre sí. Entonces Cisco tomó bits de la
prioridad para ser interpretado de otra forma. Esto toma 12 bits de los 16 del
campo prioridad para marcar las VLANs.

--------------------------------------------------------------------------------
Décima clase
--------------------------------------------------------------------------------
Tue Feb 27 12:49:40 2024

Puertos Edge vs puertos Link

Los puertos link son los que tienen otro switch, i.e, puertos que van de un
switch a otro switch.

Los puertos Edge son aquellos donde termina. Una nevera, una consola de
videojuegos, un televisor, un computador.

En los puertos Edge, podemos habilitar una feature donde podemos hacer que
funcione inmediatamente, esto tiene que ser un puerto Edge. (portfast)

#(config) interface [port]
#(config-if) switchport mode access
#(config-if) spanning-tree portfast

Se puede activar en PVSPT y RSPT

Los puertos que son de Link, esos sí, paciencia porque se tiene que hacer el
cálculo de spanning tree.

Hay otros tipos de puerto: puertos punto a punto (p2p) y shared.

Los p2p son los que solo tienen un equipo punto a punto, los shared son los que
tienen más equipos.

El switch se da cuenta que son punto a punto porque son full-duplex.

Los shared son half-duplex, esto pasa cuando lo configuramos o cuando tenemos un
hub, pero esto es raro hoy en día.

RSPT tiene dos opciones, el de la IEEE, el cual es 802.1w, el de cisco se llama
rapid-pvst.

#(config) spanning-tree mode rapd-pvst

En rapid-spanning tree, desaparece el listening y solo aparece el learning,
menos de 6 segundos.

Cuando hay un concurso, una competición, lo que sea, usted elige un principal,
si el primero se muere. el segundo lo prommueven sin tener que hacer ningún
proceso. Esto pasa en los switches con las conexiones Raíz y alternativo, si el
raíz muere, se delega al alternativo. Esto no funciona muy bien con los hubs.

--------------------------------------------------------------------------------
Décima primera clase
--------------------------------------------------------------------------------
Thu Feb 29 12:07:12 2024

Primero dibujamos los árboles para cada VLAN. Troncales + Acceso de cada VLAN.

Hay hubs de 10 megas y hay hubs de 100 megas, esto es un cuello de botella.

--------------------------------------------------------------------------------
Décima segunda clase
--------------------------------------------------------------------------------
Mon Mar  4 11:59:10 2024

Hoy entonces vamos a trabajar en un tema que es breve.

1. Los 2 enlaces simultáneos.

2. Un enlace principal activo, el resto de respaldo. (STP)

3. Agregación de enlace. Bundle.
Port Channel en Cisco, Ether channel en otros fabricantes
  - Esta agregación se puede hacer hasta 8 enlaces
  - Enlaces de la misma característica. Tipo.
  - Mismo modo. Acceso | trunk | desirable | auto
  - Trunk: misma nativa, Acceso: misma vlan
  - Mismo Duplex

El agrupammiento se puede hacer de forma manual o forma automática.
El manual se puede hacer nombrando los puertos.
Podemos también negociar y funciona de una manera similar al auto de los
trunk.

Existe protcolo de Cisco. PAgP. Port Aggregation Protocol. 
  - On. Forces to channel without PAgP
  - Desirable
  - Auto

(packets sent every 30 seconds)

IEEE - LACP -> Link aggregation control protocol. (IEEE 802.3ad)
  - On
  - Active
  - Passive

Los puertos de portchannel no tienen que ser consecutivos. Protocolo de control
dpe agregación de enlaces.

--------------------------------------------------------------------------------
Décima tercera clase
--------------------------------------------------------------------------------
Tue Mar  5 12:20:41 2024
DHCPv4

DHCPDISCOVER -> Always a broadcast, then it may be unicast
DHCPOFFER
DHCPREQUEST
DHCPACK

ip helper-address command forwards the following eight UDP services
37: Time
49: TACACS
53: DNS
67: DHCP/BOOTP server
68: DHCP/BOOTP client
69: TFTP
137: NetBIOS name
138: NetBIOS datagram

--------------------------------------------------------------------------------
Décima cuarta clase
--------------------------------------------------------------------------------
Mon Mar 11 12:29:55 2024

Preparar running config

1. version borrar hacia arriba (incluida)
2. end borrar hacia abajo (no incluida)
3. borrar bloque interface sin uso.
4. Agregar no shutdown a las interfaces con uso.
5. Confrontar show ip int brief con las interfaces en el txt.
6. vlans se deben hacer de manera manual, en los switches, no se guardan.

--------------------------------------------------------------------------------
Décima quinta clase
--------------------------------------------------------------------------------
Tue Mar 12 11:52:00 2024

# standby [group-id] ip 10.100.0.3

El entorno con VLANs es L2, el entorno sin VLAns es L3.

224.0.0.[2] HSRP
0100.5E00.000[2]

MAC virtual: 0000.0c07.ac[c8] <- Últimos dos corresponde al grupo.

Elección del activo: Mayor prioridad, si se empata, se escoge la ip más alta.
prioridad por defecto es de 100, puede tomar un valor entre 0 y 255.

#(config-if)#show standby brief -> Mostrar summary 

#(config-if)#standby [group-id] preempt -> Activar preempt

Estas carajadas son MAC multicast que no están en equipos.

show ip interface vlan 100 -> Ver cuáles multicast entiende el dispositivo.

--------------------------------------------------------------------------------
Décima sexta clase
--------------------------------------------------------------------------------
Jueves 18 de abril.

Antes había un protocolo que se llamaba bootp [boot protocol], el antecesor.
Para cada usuario se creaba un perfil, para n usuarios, asignar n perfiles. En
cada perfil se agregaba detalles similares a DHCP, pero se anclaba con la MAC.
El DHCP, en cambio, crea un pool y este se encarga de asignar las ip de manera
automática.

discover, offer, request, acknowledge.

En Ipv6 tenemos unos identificadores o direcciones de 128 bits, esos 128 bits lo
habímos dividido como de forma canónica en 2 porciones, esas porciones tienen
unos tamaños recomendados, pero no fijos, el famoso /64. El prefijo representa
la red. [Prefijo][Int ID].

Métodos de asignación de direcciones en Ipv6

Primer método: Asignación manual.
Una direción ip tiene dos partes. [prefijo (man)][int ID (man)]

El segundo método es manual más EUI-64.

En este escenario tenemos la porción del prefijo y la de interface.
[Pref (Manual)][Int ID (Auto)]

--------------------------------------------------------------------------------
Décima séptima clase
--------------------------------------------------------------------------------
22 April 2024

LLA -> When host boots and interface active.
[IPv6 Add]%[Zone ID] -> OS associate the LLA with specific interface.

DHCPv6 is defined in RFC 3315

Dynamic GUA Assignment
  Stateless
  [No device tracks the assignmet]
    SLAAC Only (A:1 O:0 M:0)
    [RA messages providing all IPv6 addressing]
    [Hosts use the RA information exclusively]
      Randomly generated
      [client OS]

      EUI-64
      [Privacy concerns]

    SLAAC with DHCP server (A:1 O:1 M:0)
    [Router RA messages provide IPv6 configuration to hosts and redirects to
    Stateless server]
    [Hosts create GUA based on RA and get additional info from server]

  Stateful (A:0 O:0 M:1)
  [Server manages the assignment]
  [RA informs about server except the default gateway]
  [Hosts contact server]

Router sends RA messages every 200 seconds or when it receives an RS message
from a host.
ff02::2 -> All routers multicast address.

Host sends an ICMPv6 NS with the last IPv6 address of the host, if no response,
the address is unique.

Métodos
1. Manual
2. Manual + EUI64

3. Autoconfig - SLAAC (stateles address auto configuration)
En este método, la interacción nuestra es mínima, una buena noticia es que los
equipos ya tienen autoconfig de fábrica. Estrategia plug and play.

Lo primero, vamos a necesitar que en la infraestructura haya al menos un router,
usted se va a esforzar un equipo capa 3, de modo que también puede ser un Switch
capa 3. Este equipo va a necesitar tener una dirección. Usted va a concentrar
sus esfuerzos en configurar el router, el default gateway. El router viene en
autoconfig, si no es así, es necesario configurarlo.

En IPV6 hay 3 métodos automaticos, pero esto no lo escoge al usuario, esto lo
hace el router y por ende esto debe estar configurado desde el router.

Importante: Si solo se pone la IP al router, el router no funciona como router.
El router se convierte en un router si al router le dices ipv6-unicast-routing,
a usted se le olvida, el router no será router, sino un dispositivo más, un
cliente.

ICMPv6
Conectividad - ping (echo request 128, echo reply 129)

Dado que no hay arp - ICMPv6 también tiene la tarea de hacer los mapping entre
IP y MAC. Neighbor solicitation y Neighbor advertisement. (NDP)

Consultar el prefijo de la red. (NDP)

FF02::2 all routers del segmento.
FF02::1 All nodes del segmento.

Ninguno de estos métodos usa un protocol extraño, todos son procedimientos
propopios de IPv6.

Nosotros hasta ahora nos hemos concentrado en los parametros manage, parametros
de gestión manage (IP, longitud del prefijo (mask), gw).

Parametros Other (DNS, Dominio).

parametros M los entrega SLAAC.

los parametros O los entrega dhcpv6.

Y cuando la M la entrega SLAAC y la O la entrega DHCPv6, se conoce como DHCP
Stateless,

Y cuando M + O lo entrega DHCP, se conoce como DHCP Stateful.

En IPv6 hay que meterse a la interfaz y decirle qué pool vas a usar.

Las banderas en 0 lo hace ICMPv6 y la 1 la hace DHCPv6

3) 0    -> Opción por defecto
4) 0 1
5) 1 1

1. Crear pool.
2. Asociar pool en interface.
3. Encender flags.

Stateless -> La dirección la entregó SLAAC, los otros parametros los entregó
DHCPv6

DHCPv6
Host sends an RS message
The router responds with an RA message
The host sends a DHCPv6 SOLICIT message
The DHCPv6 server responds with an ADVERTISE message
The host responds to the DHCPv6 server
The DHCPv6 server sends a REPLY message

RS, RA, SARR

UDP 546 server
UDP 547 client

Router can be configured as
  DHCPv6 Server
  DHCPv6 Client
  DHCPv6 Relay Agent

--------------------------------------------------------------------------------
Décima octava clase
--------------------------------------------------------------------------------
First Hop Redundancy Protocols (HSRP)
HSRP priority, 
Highest priority will become the active router.
100 default priority.
IPv4 if priorities are equal.

--------------------------------------------------------------------------------
Décima novena clase
--------------------------------------------------------------------------------
5/2/2024 12:07:52

Hoy vamos a conversar sobre la seguridad en las LAN, durante muchos años toda la
fuerza se concentró en conectar. En ese nos hemos concentrado en el curso, en
conectar. Siempre si lo han notado, acabamos cuando hay ping de extremo a
extremo. Después de los años 80 y 90, se empezó a abrir otra temática, era el
tema de la seguridad. Los que implementaban las redes solo lo conectaban, no les
interesaba la seguridad. Desde los años 90 en adelante, la persona que montaba
la red también pensaba cómo hacer las cosas seguras. El tema se volvió tan
relevante que en la gram mayoría de empresas hay un grupo de trabajo para la
infraestructura, pero también hay un grupo de trabajo independiente de
ciberseguridad. Ya esto se convirtió en una rama independiente, primero era como
un extra, ahora es algo completamente independiente en la seguridad, además,
ahora hay profesionales que solo se enfocan en este tema. Visto desde la parte
de seguridad, entonces eso a través de aquí en adelante vamos a mirar mucho ese
tema.

Nosotros vamos a hablar de seguridad en la LAN porque estos cursos estan
orientados a la LAN.

10.1 Endpoint Security. 

El ser humano es el eslabón más débil de la seguridad.
Porque es muy fácil engañar a la gente.

Con los usuarios finales están los tres ataques más conocidos, el DDos, Data
Breach y Malware.

Defensas

Virtual Private Network (VPN)

Next-Generation Firewall (NGFW)

Network Access Control (NAC)

802.1x -> Protocolo para usar un switch, creo, como autenticador y hasta que no
se autentique no se da acceso.

--------------------------------------------------------------------------------
Vigésima clase
--------------------------------------------------------------------------------
Vamos a centrarnos en esta clase en la manera de configurar de manera básica
seguridad.

1. Port-fast Un atacante podría convertirse en el raíz de spanning tree, para
esto es preferible convertir todos los enlaces a puertos finales (port-fast,
edge).

2. BPDU Guard Si un switch intenta enviar información mediante un puerto Edge,
este se desactivará con err_disable.

#spanning-tree bpdu guard enable 
#spanning-tree bpdu default (Todos los puertos)

DHCP snooping, para evitar el dhcp starvation

Nunca dejar los puertos en dinámico auto y preferiblemente pasarlos a una VLAN
sin uso.

Nunca poner la VLAN 1 como nativa.

3. Port security.

Port-security, limitar en un puerto limitar los flujos basados en el orígen.
# sw mode acccess
# sw port-security maximum 2
# sw port-security mac [mac]
# sw port-security mac sticky

4. Port security violation

Existen 3 aleternativas para la violación.

Protect, Strict y shutdown(defecto)

Protect -> Bloquea (Bloquea el flujo extraño)
Restrict -> Bloquea (Envía notificaciones)[Logs]
Shutdown -> Apaga (Envía notificaciones)[Logs]

--------------------------------------------------------------------------------
Vigésima primera clase
--------------------------------------------------------------------------------
En redes uno discutimos un poco sobre redes inalambricas.

En ese entonces la frecuencia usada era 2.4GHz con una banda ancha de 2Mbps, era
poco atractivo debido a su velocidad, por lo que la IEEE empezó a anexar.
1 - Legacy 1997 2.4Ghz 2Mbps.
  
2 - Anexo a 1999 -> 802.11a: 5Ghz 54Mbps. Le custa superar obstáculos, pero va a
    más velocidad.
    
2 - Anexo b 1999 -> 802.11b: 2.4Ghz 11Mbps. Supera obstáculos con más
    facilidad, pero es más lenta.

3 - Anexo g 2003 -> 2.4Ghz 54Mbps. Esta tomó lo mejor de las anteriores.

4 - Anexo n 2009 -> 2.4Ghz/5Ghz. 600Mbps. Debe tener 4 antenas, cada antena de
    aproximadamente 150.

5 - Anexo ac 2013 -> 5Ghz. 1.3Gbps. Se hizo tan popular el 2.4Ghz que se saturó.

6 - Anexo ax 2020 -> 2.4Ghz/5Ghz/6Ghz. 9Gbps. El famoso Wi-Fi 6.

AP autónomos (Muy manual)[Uno por uno]

SSID -> Identificador de conjunto de servicios. 

AP controladora 
APs esclavos. LWAPP, Radius, LDAP.

WPA-2 Personal (Una clave)
WPA-2 Enterprise (Server y demás, es más complejo)

802.1p lo mismo, pero en redes cableadas.
802.1x lo mismo, pero en redes cableadas.

Modelo Meraki

Servidor Meraki con servidor controladora y servidor de autenticación.

ad-hoc -> No AP.

Pre-shared key PSK
Cisco compró Meraki, (buscar al respecto).

--------------------------------------------------------------------------------
Vigésima segunda clase
--------------------------------------------------------------------------------
5/21/2024 12:18:17

Hoy vamos a continuar trabajando en el modelo Meraki.

En un script de configuración:
Primero se tiran los comando configs.

hostname SWA-1
!
vlan 10
 name EMPLEADOS
vlan 20
 name INVITADOS
vlan 30
 name ADMIN
vlan 40
 name NATIVA
!
int range f0/24, g0/1-2
 sw mode trunk
 sw trunk native vlan 40
!
int f0/1
 sw mode access
 sw access vlan 30
!
int vlan 30
 ip add 10.30.0.2 255.255.0.0
 no sh

! Config en el router

hostname RA
!
int g0/0/0
 no sh
int g0/0/0.10
 encapsulation dot1q 10
 ip add 10.10.0.1 255.255.0.0
int g0/0/0.20
 encapsulation dot1q 20
 ip add 10.20.0.1 255.255.0.0
int g0/0/0.30
 encapsulation dot1q 30
 ip add 10.30.0.1 255.255.0.0

--------------------------------------------------------------------------------
Vigésima tercera clase
--------------------------------------------------------------------------------
5/23/2024 12:10:07


--------------------------------------------------------------------------------
Vigésima cuarta clase
--------------------------------------------------------------------------------
5/28/2024 12:10:24

El modelo Meraki surgió como un startup.

Meraki pensó en la controladora como un equipo que no esté en la
infraestructura, sino en la nube, con el objetivo de tener un mejor acceso.

Un Wrouter es un todo en uno, ese equipo tiene un router, una interfaz, llamada
internet o interfaz WAN que va hacia el proveedor y la otra interfaz es Ethernet
lAN Intranet y eso va pegado a un switch que tiene n puertos. Además, este
Switch va pegado a un AP que provee una red inalambrica

--------------------------------------------------------------------------------
Vigésima quinta clase ?
--------------------------------------------------------------------------------
Tue Jul 30 11:54:40 -05 2024

--------------------------------------------------------------------------------
Vigésima sexta clase ?
--------------------------------------------------------------------------------
Thu Aug  1 12:13:47 PM -05 2024

PC1: 90-B1-1C-76-89-EC
PC2: 90-B1-1C-CD-07-3F
PC3: 90-B1-1C-77-80-E1

macoff para evitar que los atacantes nos hagan flood de MACs.
# clear mac address-table dynamic -> Eliminar tabla MAC

Port security, 3 configuraciones. Tiene que estar en acceso.

--------------------------------------------------------------------------------
Vigésima séptima clase ?
--------------------------------------------------------------------------------
Mon Aug  5 11:55:03 AM -05 2024
Moved to config

--------------------------------------------------------------------------------
Vigésima octava clase ?
--------------------------------------------------------------------------------
Mon Aug 12 12:03:16 PM -05 2024

El router si no tiene una ruta para llegar al otro lado, descarta el paquete,
entonces el enrutamiento es muy importante.

El router necesita tener la información de destino.

Manual -> Estático
Dinámico -> como rip.

Los PCs tienen habilidades de capa 3. Pueden ser enrutadores. 
Y tiene una tabla de enrutamiento.
Si hay mas de una interfaz de red, se puede personalizar.

Imprimir rutas.
$ route print
$ netstat -r

La información de las tablas se toma de las tarjetas de red.

La métrica es una columna que asigna el sistema operativo, entre menor, más
preferida.

Si la ruta ya está en la tabla se hace con CHANGE, sino, se hace con ADD

$ route ADD 8.0.0.0 MASK 255.0.0.0 127.0.0.1 METRIC 10 IF 1

{
interface Gig 0/0/0
  ip address 10.0.0.1 255.0.0.0
  no shutdown

interface Gig 0/0/1
  ip address 192.168.1.50 255.255.255.240
  no shutdown
}

{
ip route 0.0.0.0 0.0.0.0 Gig 0/0/1
}

Si no se puede mandar paquetes por el cable, el router no pone información en la
tabla. Up/up

L es host específico, mientras la C es la red completa e incluye a todos los
dispositivos.

Los caballeros routers y switches tienen debugs. Los shows son normalmente
comandos que hacen resumen, los debugs son eventos, cada vez que suceda algo, yo
con el debug le digo qué es lo que quiero ver, por ejemplo, cada vez hay un
evento, como cada vez que la interfaz sube o baja.

         Show                            Debug
         - Resumen                       - Eventos
         - Por solicitud                 - Por ocurrencia

# debug ip routing

Ver debugs encendidos

# show debug
# no debug ip routing
# undebug
# no debug all
--------------------------------------------------------------------------------
Vigésima octava clase ?
--------------------------------------------------------------------------------
Siempre que es multi acceso se usa el ip del siguiente salto.

#(config)ip route 10.18.18.128 255.255.255.128 S0/2/0

RA
{
ip route 0.0.0.0 0.0.0.0 10.18.18.218
}

RB
{
ip route 10.18.18.208 255.255.255.248 10.18.18.217
ip route 10.18.16.0 255.255.254.0 10.18.18.3
ip route 10.18.18.224 255.255.255.252 10.18.18.2
ip route 10.18.18.228 255.255.255.252 10.18.18.2
ip route 10.18.18.128 255.255.255.128 10.18.18.2
}

RC
{
ip route 10.18.18.208 255.255.255.248 10.18.18.1
ip route 10.18.18.216 255.255.255.248 10.18.18.1
ip route 10.18.18.224 255.255.255.252 10.18.18.2
ip route 10.18.18.228 255.255.255.252 10.18.18.2
ip route 10.18.18.128 255.255.255.128 10.18.18.2
}

RD
{
ip route 10.18.18.128 255.255.255.128 Se 0/2/1
ip route 10.18.16.0 255.255.254.0 10.18.18.3
ip route 10.18.18.216 255.255.255.248 10.18.18.1
ip route 10.18.18.208 255.255.255.248 10.18.18.1
}

RE
{
ip route 0.0.0.0 0.0.0.0 Se0/2/0
}

--------------------------------------------------------------------------------
Vigésima novena clase ?
--------------------------------------------------------------------------------
Thu Aug 15 12:17:23 PM -05 2024

Rutas flotantes
AD: 0 - 255, elegibilidad, favorabilidad
Entre más pequeño mejor

C -> distancia 0
S -> distancia 1

ip route 0.0.0.0 0.0.0.0 Se0/2/0 [metric]

Si la distancia es igual, no es una ruta flotante.

Búsqueda recursiva se da cuando en el router no se encuentra la interfaz en la
línea.

Hay routers que permiten ambos argumentos, en este caso los llamamos rutas
totalmente definidas.

R1
{
interface fast0/0
  ip address 10.1.0.1 255.255.255.0
  no shutdown
interface fast 0/1
  ip address 10.12.0.1 255.255.0.0
  no shutdown
interface serial0/0/0
  ip address 10.21.0.1 255.255.0.0
  no shutdown
  clock rate 64000
}

R2
{
hostname R2

interface fast0/0
  ip address 10.2.0.1 255.255.255.0
  no shutdown
interface fast 0/1
  ip address 10.12.0.2 255.255.0.0
  no shutdown
interface serial0/0/0
  ip address 10.21.0.2 255.255.0.0
  no shutdown
}

--------------------------------------------------------------------------------
Vigésima novena clase ?
--------------------------------------------------------------------------------
Tue Aug 20 12:30:09 PM -05 2024

show control S0/0/0 | include clock 

Ruta estática en IPV6 
ipv6 route 2800::5:0/64 S2 [fa0/1] [2000::1]
                           int local siguiente salto 

--------------------------------------------------------------------------------
Nota para Minicom
--------------------------------------------------------------------------------
$ dmesg | grep tty
[0.090183] printk: legacy console [tty0] enabled
[5.098062] systemd[1]: Created slice system-getty.slice - Slice /system/getty.
[5.100139] systemd[1]: Reached target getty.target - Login Prompts.

Looking for something like ttyS0 and that goes to the minicom Serial config.

--------------------------------------------------------------------------------
Estudiando para el último parcial
--------------------------------------------------------------------------------

! Enable port-security

(config)# interface f0/1
(config-if)# switchport mode access
(config-if)# switchport port-security

# show port-security interface f0/1
(config-if)# switchport port-security ?

! Limit MAC addersses allowed on a port
(config-if)# switchport port-security maximum 1 -> Va desde 1 hasta 8192

! Configurar manual
(config-if)# switchport port-security mac-address [MAC]

! Configurar auto
(config-if)# switchport port-security mac-address sticky

! Aging
(config-if)# switchport port-security aging { static | time [time] | type
{absolute | inactivity }}

! Protection
(config-if)# switchport port-security violation { protect | restrict | shutdown }

! Checking
# show port-security
# show port-security fa0/5
# show port-security address

! VLAN attacks related stuff

================================================================================
Commands
================================================================================

! Active ports
S1(config)# interface range fa0/1 - 16
S1(config-if-range)# switchport mode access
S1(config-if-range)# exit
S1(config)# 
! Unused ports
S1(config)# interface range fa0/17 - 20
S1(config-if-range)# switchport mode access
S1(config-if-range)# switchport access vlan 1000
S1(config-if-range)# shutdown
S1(config-if-range)# exit
S1(config)# 
! Trunks
S1(config)# interface range fa0/21 - 24
S1(config-if-range)# switchport mode trunk
S1(config-if-range)# switchport nonegotiate
S1(config-if-range)# switchport trunk native vlan 999
S1(config-if-range)# end
S1#

! Snooping

S1(config)# ip dhcp snooping
S1(config)# interface f0/1
S1(config-if)# ip dhcp snooping trust
S1(config-if)# exit
S1(config)# interface range f0/5 - 24
S1(config-if-range)# ip dhcp snooping limit rate 6
S1(config-if-range)# exit
S1(config)# ip dhcp snooping vlan 5,10,50-52
S1(config)# end
S1#

! DAI

S1(config)# ip dhcp snooping
S1(config)# ip dhcp snooping vlan 10
S1(config)# ip arp inspection vlan 10
S1(config)# interface fa0/24
S1(config-if)# ip dhcp snooping trust
S1(config-if)# ip arp inspection trust

! Portfast

S1(config)# interface fa0/1
S1(config-if)# switchport mode access
S1(config-if)# spanning-tree portfast

! BPDU Guard

S1(config)# interface fa0/1
S1(config-if)# spanning-tree bpduguard enable

!-------------------------------------------------------------------------------
!                                 EtherChannel
!-------------------------------------------------------------------------------

! support, speed and duplex [same], same vlan or trunk
(config)# interface range FastEthernet 0/1 - 2
(config-if-range)# channel-group 1 mode active
(config-if-range)# exit
(config)# interface port-channel 1
(config-if)# switchport mode trunk
(config-if)# switchport trunk allowed vlan 1,2,20

show interfaces port-channel
show etherchannel summary
show etherchannel port-channel
show interfaces etherchannel

!-------------------------------------------------------------------------------
!                                    DHCPv4
!-------------------------------------------------------------------------------

! Exclude addresses, define pool name, configure pool
(config)# ip dhcp excluded-addresses 192.168.10.1 192.168.10.9
(config)# ip dhcp excluded-addresses 192.168.10.254
(config)# ip dhcp pool LAN-POOL-1
(dhcp-config)# network 192.168.10.0 255.255.255.0
(dhcp-config)# default-router 192.168.10.1
(dhcp-config)# dns-server 192.168.11.5
(dhcp-config)# domain-name example.com
(dhcp-config)# end

! Stats
show running-config | section dhcp
show ip dhcp binding
show ip dhcp server statistics

! Disable
(config)# no service dhcp
(config)# service dhcp

! Relay
(config)# interface g0/0/0
(config-if) ip helper-address 192.168.11.6
(config-if) end

show ip interface g0/0/0

! Router as DHCPv4 client
(config)# interface g0/0/1
(config-if)# ip address dhcp
(config-if)# no shutdown

show ip interface g/0/0/1

!-------------------------------------------------------------------------------
!                                    DHCPv6
!-------------------------------------------------------------------------------

! Enable ipv6 routing
(config)# ipv6 unicast-routing

(config-if)# ipv6 address [ipv6-address/prefix-lenght]

! SLAAC
(config-if)# ipv6 address autoconfig

! Reset
(config-if)# ipv6 nd prefix default no-autoconfig

! SLAAC + DHCPv6
(config-if)# ipv6 nd other-config-flag
(config-if)# end

show ipv6 interface g0/0/1 | begin ND

! Reset
(config-if)# no ipv6 nd other-config-flag

! Stateful
(config-if)# ipv6 nd managed-config-flag
(config-if)# end

show ipv6 interface g0/0/1 | begin ND

! Reset
(config-if)# no ipv6 nd managed-config-flag

! Configure Stateless DHCPv6 Server
! enable ipv6 routing, define pool, configure pool options, bind interface 

(config)# ipv6 unicast-routing
(config)# ipv6 dhcp pool IPV6-STATELESS
(config-dhcpv6)# dns-server 2001:db8:cafe:aaaa::5
(config-dhcpv6)# domain-name example.com
(config-dhcpv6)# exit

(config)# interface g0/1
(config-if)# ipv6 address 2001:db8:cafe:1::1/64
(config-if)# ipv6 dhcp server IPV6-STATELESS
(config-if)# ipv6 nd other-config-flag

! Configure a Stateless DHCPv6 Client
! enable ipv6 routing, LLA, set SLAAC

! Configure a Stateful DHCPv6 Server
! enable ipv6 routing, pool, pool options, bind interface.

! Configure a Stateful DHCPv6 Client
! enable ipv6 routing, LLA, ipv6 dhcp

show ipv6 dhcp pool
show ipv6 dhcp binding

! DHCP relay agent
(config)# interface gigabitethernet 0/0/1
(config-if)# ipv6 dhcp relay destination 2001:db8:acad:1::2 g0/0/0
(config-if)# exit

show ipv6 dhcp interface
show ipv6 dhcp binding

!-------------------------------------------------------------------------------
!                                     HSRP
!-------------------------------------------------------------------------------
(config-if) standby priority [0 - 255]
(config-if) standby preempt

Initial   Speak
Learn     Standby
Listen
